{{ block content }}


<body>

<p>{{ form.age.label }}<br><br>
{{ form.age }}
    {{ formfield_errors 'age' }}</p>

<p>{{ form.gender.label }}
{{ form.gender }}
    {{ formfield_errors 'gender' }}</p>

<p>{{ form.education.label }}
{{ form.education }}
{{ formfield_errors 'education' }}
    <span id="education_message" style="color:#990000"></span></p>

<p>{{ form.income.label }}
{{ form.income }}
{{ formfield_errors 'income' }}
    <span id="income_message" style="color:#990000"></span></p>


</body>

<input type="hidden" name="ts_demo" id="ts_demo"/>

<button type="button" class="btn btn-primary" onclick="Validate()">Next</button>


<span id="fields" style="color:#990000"></span>
<span id="messages" style="color:#990000"></span>
<span id="messages2" style="color:#990000"></span>

<script>

    let optional_fields = js_vars.optional_fields;
    let times_submitted = 0;

    fields.innerHTML = optional_fields
    messages2.innerHTML = times_submitted

    function Validate() {
        var items = []
        let isValid = []
        let messages = []

        //each time the next button is pressed, times submitted increments
        times_submitted++
        if (times_submitted >= 2) {
            form.submit()   //optional submission - if next is hit twice or more, submit
        } else { // if not hit more than twice...
            messages.innerHTML = ['hey', 'ho']
            for (i = 0; i < optional_fields.length; i++) {
                isValid[i] = false
                messages[i] = "Please fill out this field"

                items.push(Array.from(document.getElementsByName(optional_fields[i])))        //Reference the Group of optional questions.

                for (var j = 0; j < items[i].length; j++) {
                    if (items[i][j].checked) {
                        // if at least one radio is checked for the question, return true and change item's message to blank
                        isValid[i] = true;
                        messages[i] = "";
                    } else {
                        scroll(0, 0)
                    }


                }
            }
            education_message.innerHTML = messages[0]
            income_message.innerHTML = messages[1]
        }
    }

    //This bit creates 2 variables, one will function as a timer, the other will hold the timer output. They are set to 0 and -1 here to initialise them, these will not be the final outputs.
var pageTimeElapsed = 0;
var pageTimerID = -1;

//This function automatically starts the timer when the page loads. In this case I want seconds so the interval is set to 1000, but I believe if you set it to 1 then it will count milliseconds - you will need to test this
window.onload = function() {
  if(pageTimerID == -1){
    pageTimerID = setInterval(pageTick, 1000);
  }
};

//This function captures the timer output. When the timer starts it will increase 'pageTimeElapsed' every second and send this value to the 'timeSpent' variable that will be saved
//When a person moves to the next page, or the page times out, the final value that the timer was on will be saved. The value resets each round/page.
function pageTick() {
  pageTimeElapsed++
  document.getElementById("ts_demo").value = pageTimeElapsed;
}

</script>


{{ endblock }}
